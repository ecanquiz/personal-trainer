import{_ as k}from"./B4MrYYX4.js";import{H as S}from"./DCKQnB1R.js";import $ from"./DMMS63QV.js";import B from"./CaLtcwMX.js";import E from"./D7voIVEO.js";import{_ as I}from"./YIOOAlkI.js";import F from"./BFqGZ-md.js";import{f as b,r as N,o as w,h as R,w as c,b as a,a as i,d as x,t as A,i as C,j as h,n as j,c as q,k as _}from"./CiMQqf--.js";import{u as D,l as G,g as L}from"./CXcXRdQD.js";import"./DlAUqK2U.js";import"./BU5l9KzU.js";import"./DsV20Ehl.js";import"./qsMMcMsd.js";import"./DWCSeOIi.js";import"./uZe-Fh7_.js";import"./B7QgX8ed.js";import"./BlknvQPu.js";import"./BOyhsQNo.js";import"./aPxrJPp6.js";import"./blSOxsGD.js";import"./9QP_JJzH.js";const P={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between mt-4"},T=i("label",{class:"flex items-center"},[i("input",{type:"checkbox",class:"rounded border-gray-300 text-indigo-600 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50i mb-4",name:"remember"}),i("span",{class:"ml-2 mb-3 text-sm text-gray-600"}," Recuérdame ")],-1),H=b({__name:"FormLogin",props:{error:{},sending:{type:Boolean}},emits:["submit"],setup(p,{emit:r}){const o=p,d=r,e=N({email:"",password:""}),l=t=>/\S+@\S+\.\S+/.test(t),n=t=>t.length>5,m=t=>{const s=[];return t.email||s.push({path:"email",message:"Required"}),t.password||s.push({path:"password",message:"Required"}),l(t.email)||s.push({path:"email",message:"Requires a valid email"}),n(t.password)||s.push({path:"password",message:"The password must be at least 6 characters"}),s},y=async t=>{d("submit",{email:e.email,password:e.password})};return(t,s)=>{const g=$,f=B,v=E,U=I,V=F;return w(),R(V,{validate:m,state:e,class:"space-y-4",onSubmit:C(y,["prevent"])},{default:c(()=>[a(f,{label:"Email",name:"email"},{default:c(()=>[a(g,{type:"email",label:"Correo Electrónico",name:"email",modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=u=>e.email=u),autocomplete:"email",placeholder:"email@domain.ext",class:"mb-2","data-testid":"email-input"},null,8,["modelValue"])]),_:1}),a(f,{label:"Password",name:"password"},{default:c(()=>[a(g,{type:"password",label:"Contraseña",name:"password",placeholder:"password",modelValue:e.password,"onUpdate:modelValue":s[1]||(s[1]=u=>e.password=u),class:"mb-4","data-testid":"password-input"},null,8,["modelValue"])]),_:1}),i("div",P,[T,a(v,{color:"lime",class:"justify-center",type:"submit",isDisabled:o.sending,"data-testid":"submit-btn"},{default:c(()=>[x(A(o.sending?"Iniciando sesión...":"Iniciar sesión"),1)]),_:1},8,["isDisabled"])]),a(U,{error:o.error},null,8,["error"])]),_:1},8,["state"])}}});function M(){const p=D(),r=h(null),o=h(!1);return{login:async e=>{const l={email:e.email,password:e.password};r.value=null;try{o.value=!0,await G(l);const n=await p.getAuthUser();if(console.log(n),n)p.setGuest({value:"isNotGuest"}),await j({path:"/dashboard"});else{const m=Error("Unable to fetch user after login, check your API settings.");throw m.name="Fetch User",m}}catch{r.value=L()}finally{o.value=!1}},sending:o,error:r}}const z={class:"p-5"},J=i("h2",{class:"text-2xl text-center mx-auto absolute bottom-0"},"Inicio de Sesión",-1),K={class:"mt-2 text-center text-gray-500"},O=i("br",null,null,-1),fe=b({__name:"login",setup(p){const{login:r,sending:o,error:d}=M();return(e,l)=>{const n=k;return w(),q("div",z,[a(S,null,{default:c(()=>[J]),_:1}),a(H,{class:"p-5 bg-base-200 rounded shadow",onSubmit:l[0]||(l[0]=m=>_(r)(m)),sending:_(o),error:_(d)},null,8,["sending","error"]),i("p",K,[a(n,{to:"/register",class:"text-gray-500 transition hover:text-gray-600","data-testid":"register-link"},{default:c(()=>[x(" Regístrese para obtener una cuenta ")]),_:1}),O])])}}});export{fe as default};
