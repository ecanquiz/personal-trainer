import{f as g,r as h,z as w,o as y,c as V,a as l,b as m,i as U,C as k,j as C,l as $,G as S,d as B,t as A,k as i,w as E,T as G}from"./CiMQqf--.js";import{_ as N}from"./Dh77eSKz.js";import{_ as R}from"./u3Q2zNCO.js";import{u as T,U as b}from"./C1AkYAFr.js";import"./CXcXRdQD.js";const D={class:"grid lg:grid-cols-2 gap-4"},j={class:"block"},M={class:"block"},O={class:"block"},z={class:"block"},F={class:"mt-4 px-2 border-gray-100 flex justify-end space-x-2"},H=g({__name:"FormCreateOrEdit",props:{id:{},user:{},sending:{type:Boolean},errors:{},roles:{}},emits:["submit"],setup(c,{emit:a}){const t=c,p=a,r=h(t.user),n=async()=>{p("submit",{name:r.name,email:r.email,password:r.password,role_id:r.role_id},t.id)};return(s,o)=>{const u=N,v=w("AppSelect"),f=R;return y(),V("form",{onSubmit:U(n,["prevent"]),class:"p-4"},[l("div",D,[l("div",j,[m(u,{modelValue:r.name,"onUpdate:modelValue":o[0]||(o[0]=e=>r.name=e),label:"Name",type:"text",error:s.errors&&s.errors.name?s.errors.name[0]:""},null,8,["modelValue","error"])]),l("div",M,[m(u,{modelValue:r.email,"onUpdate:modelValue":o[1]||(o[1]=e=>r.email=e),label:"Correo",type:"text",error:s.errors&&s.errors.email?s.errors.email[0]:""},null,8,["modelValue","error"])]),l("div",O,[m(u,{modelValue:r.password,"onUpdate:modelValue":o[2]||(o[2]=e=>r.password=e),label:"Password",type:"password",error:s.errors&&s.errors.password?s.errors.password[0]:""},null,8,["modelValue","error"])]),l("div",z,[m(v,{options:s.roles,modelValue:r.role_id,"onUpdate:modelValue":o[3]||(o[3]=e=>r.role_id=e),label:"Rol",error:s.errors&&s.errors.role_id?s.errors.role_id[0]:""},null,8,["options","modelValue","error"])])]),l("div",F,[m(f,{type:"submit",text:s.sending?"Guardando...":"Guardar",isDisabled:s.sending},null,8,["text","isDisabled"])])],32)}}}),P=c=>{const a=k(),t=h({name:"",email:"",password:"",role_id:""}),p=C([]),{errors:r,sending:n,loading:s,getError:o}=T();$(async()=>{c&&(s.value=!0,b.getUser(c).then(e=>{t.name=e.data.data.name,t.email=e.data.data.email,t.password=null,t.role_id=e.data.data.role_id}).catch(e=>{r.value=o(e)}).finally(()=>{s.value=!1})),s.value=!0,b.helperTablesGet().then(e=>{p.value=e.data.roles}).catch(e=>{r.value=o(e)}).finally(()=>{s.value=!1})});const u=async e=>(n.value=!0,b.insertUser(e).then(d=>{alert(d.data.message),a.push({path:"/users"})}).catch(d=>{console.log(d.response.data),r.value=o(d)}).finally(()=>{n.value=!1})),v=async(e,d)=>(n.value=!0,b.updateUser(d,e).then(_=>{alert(_.data.message),a.push({path:"/users"})}).catch(_=>{console.log(_.response.data),r.value=o(_)}).finally(()=>{n.value=!1}));return{user:t,errors:r,roles:p,sending:n,loading:s,router:a,submit:(e,d)=>{d?v(e,d):u(e)}}},q={class:"panel mt-6 p-4"},J={class:"flex space-x-2"},K={class:"panel mt-6"},Z=g({__name:"[id]",setup(c){const{currentRoute:a}=S(),{user:t,errors:p,roles:r,sending:n,loading:s,router:o,submit:u}=P(a.value.params.id);return console.log(a.value.params.id),(v,f)=>(y(),V("div",null,[B(A(i(a).params.id)+" ",1),m(G,{name:"fade",mode:"out-in"},{default:E(()=>[l("div",q,[l("div",J,[l("button",{class:"btn btn-primary mb-4",onClick:f[0]||(f[0]=e=>i(o).push({path:"/users"}))}," Ver todos ")]),l("div",K,[m(H,{class:"p-5 border rounded shadow",onSubmit:i(u),id:i(a).params.id,user:i(t),sending:i(n),errors:i(p),roles:i(r)},null,8,["onSubmit","id","user","sending","errors","roles"])])])]),_:1})]))}});export{Z as default};
